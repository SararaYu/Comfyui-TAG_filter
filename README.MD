这是一个用于文本标签智能分类的ComfyUI自定义节点，可通过预定义的特征词库对输入文本进行多维度动态过滤。支持角色特征、服装特征、3组自定义分类的独立控制，并包含全局排除功能，特别适合需要精细管理大量标签的场景（如AI绘画提示词处理）。

🎯 核心功能
六维智能分类
角色特征过滤

自动提取与角色相关的标签（如蓝眼睛、长头发）

服装类过滤

识别服装相关标签（如连衣裙、运动鞋）

自定义分类 ×3

用户可定义任意特征分类（如画风、背景、镜头类型）

其他标签

自动归类未匹配任何特征的剩余标签

高级控制
独立开关控制：每个分类可单独启用/禁用

排除黑名单：全局过滤不需要的标签

智能分隔：兼容中英文逗号混合输入

引号保护：支持带引号的复合标签（如"科幻背景"）

🛠️ 输入输出说明
输入参数
参数名称	类型	默认值	说明
text_input	STRING	-	原始文本（逗号分隔）
character_features	STRING	-	角色特征词（逗号分隔）
character_toggle	INT	1	角色分类开关（0关/1开）
clothing_features	STRING	-	服装特征词（逗号分隔）
clothing_toggle	INT	1	服装分类开关
custom1-3_features	STRING	-	自定义特征词（逗号分隔）
custom1-3_toggle	INT	1	自定义分类开关
exclude_features	STRING	-	全局排除词（逗号分隔）
输出结果
输出端口	说明
总输出	过滤后的完整标签列表
角色特征	匹配角色特征的标签
服装类	匹配服装特征的标签
自定义1-3	匹配自定义特征的标签
其他	未匹配任何特征的标签
🧩 使用示例
场景：AI绘画提示词过滤
输入配置：

text_input = "女孩, 金色长发, 红色连衣裙, 樱花背景, 水彩画风, 柔光效果, 8k高清"

character_features = "长发, 眼睛, 发型"
clothing_features = "连衣裙, 外套, 鞋子" 
custom1_features = "水彩, 油画, 素描"
exclude_features = "效果, 高清"
输出结果：

复制
总输出：女孩, 金色长发, 红色连衣裙, 樱花背景, 水彩画风, 柔光效果, 8k高清
角色特征：金色长发
服装类：红色连衣裙
自定义1：水彩画风
其他：女孩, 樱花背景
开关控制演示
当关闭服装分类开关（clothing_toggle=0）时：

复制
服装类："" (空字符串)
其他：女孩, 樱花背景, 红色连衣裙
⚙️ 技术细节
匹配规则
智能模糊匹配：只要标签包含特征词即触发匹配

# 示例：特征词"眼睛"会匹配"蓝眼睛"和"眼睛特写"
排除优先级：全局排除词过滤最先执行

去重机制：各分类结果自动去重

特殊格式支持
输入格式	处理结果
"红色, 连衣裙"	视为单个标签红色连衣裙
水彩画风，soft_lighting	兼容中英文逗号
'自然光', "黄昏时刻"	自动去除引号
💡 最佳实践
渐进式配置

先设置主要特征词，逐步添加自定义分类

特征词优化

使用核心关键词（如用外套替代红色外套）

排除策略

将低质量标签（如低分辨率）加入全局排除

组合使用

# 将输出端口接入不同处理流程
[角色特征] -> 人物Lora专用通道
[自定义1] -> 画风控制模型
❗ 注意事项
输入文本建议控制在200个标签以内以保证性能

特征词列表长度建议不超过50个词

当标签同时匹配多个分类时：

# "古风连衣裙"会同时出现在角色特征（若包含"古风"）和服装类
开关关闭时对应端口返回空字符串

📜 版本记录
v1.0 (2024.03) 初始版本

v1.1 (2024.05) 增加引号支持

作者Sarara QQ 2974764248